---
title: XSS vulnerability in link popover
meta:
  title: XSS vulnerability in link popover | Tiptap Resources
  description: The Link Popover UI Component accepted malicious URLs, allowing potential XSS attacks.
  category: Resources
incident:
  product: UI Component
  date: Jun 25, 2025, 9:39 PM GMT+2
  status: Resolved
  severity: high
---
import { Callout } from '@/components/ui/Callout'

The [Link Popover UI Component](/ui-components/components/link-popover) accepted malicious URLs, allowing potential XSS attacks.

**Affected components**
- [Link popover component](/ui-components/components/link-popover) until Jun 25, 2025, 9:39 PM GMT+2
- [Simple editor template](/ui-components/templates/simple-editor) until Jun 25, 2025, 9:39 PM GMT+2

**Not affected**

- Other UI components or templates
- The Link extension itself
- Components or templates downloaded after Jun 25, 2025, 9:39 PM GMT+2

### Why it happened
The vulnerable component bypassed `editor.commands.setLink()`, which normally validates URLs and blocks unsafe values like `javascript:`. This was done to avoid errors when the Link extension wasn’t registered, but it also skipped validation.

<Callout title="Note" variant="info">
The Link extension itself includes proper URL validation (see [isAllowedUri](/editor/extensions/marks/link#isalloweduri)).
</Callout>

## What’s the fix
The component now validates every URL through the Link extension’s `editor.commands.setLink()`, and it performs an additional check when the »Open in new window« button is clicked, ensuring that unsafe schemes like `javascript:` are rejected in both cases.

### How to update

To update the code in your existing project run the following command in your terminal:

```bash
npx @tiptap/cli add link-popover
```

This will download the latest version of the link popover UI component.

**Manual upgrade**

Download the latest source:

[View on GitHub](https://github.com/ueberdosis/tiptap-ui-components/blob/main/apps/web/src/components/tiptap-ui/link-popover/link-popover.tsx)

Replace your existing implementation with this version.